<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Very simple ecosystem model — VSEM â€¢ BayesianTools</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">BayesianTools</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/BayesianTools.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/florianhartig/BayesianTools">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Very simple ecosystem model</h1>
    </div>

    
    <p>A very simple ecosystem model, based on three carbon pools and a basic LUE model</p>
    

    <pre class="usage"><span class='fu'>VSEM</span>(<span class='kw'>pars</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='kw'>KEXT</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>LAR</span> <span class='kw'>=</span> <span class='fl'>1.5</span>, <span class='kw'>LUE</span> <span class='kw'>=</span> <span class='fl'>0.002</span>, <span class='kw'>GAMMA</span> <span class='kw'>=</span> <span class='fl'>0.4</span>, <span class='kw'>tauV</span> <span class='kw'>=</span> <span class='fl'>1440</span>,
  <span class='kw'>tauS</span> <span class='kw'>=</span> <span class='fl'>27370</span>, <span class='kw'>tauR</span> <span class='kw'>=</span> <span class='fl'>1440</span>, <span class='kw'>Av</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>Cv</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>Cs</span> <span class='kw'>=</span> <span class='fl'>15</span>, <span class='kw'>Cr</span> <span class='kw'>=</span> <span class='fl'>3</span>), <span class='no'>PAR</span>,
  <span class='kw'>C</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>pars</th>
      <td><p>a parameter vector with parameters and initial states</p></td>
    </tr>
    <tr>
      <th>PAR</th>
      <td><p>Forcing, photosynthetically active radiation (PAR) MJ /m2 /day</p></td>
    </tr>
    <tr>
      <th>C</th>
      <td><p>switch to choose whether to use the C or R version of the model. C is much faster.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a matrix with colums NEE, CV, CR and CS units and explanations see details</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This Very Simple Ecosystem Model (VSEM) is a 'toy' model designed to be very simple but yet bear some resemblance to deterministic processed based ecosystem models (PBMs) that are commonly used in forest modelling.</p>
<p>The model determines the accumulation of carbon in the plant and soil from the growth of the plant via photosynthesis and senescence to the soil which respires carbon back to the atmosphere.</p>
<p>The model calculates Gross Primary Productivity (GPP) using a very simple light-use efficiency (LUE) formulation multiplied by light interception. Light interception is calculated via Beer's law with a constant light extinction coefficient operating on Leaf Area Index (LAI).</p>
<p>A parameter (GAMMA) determines the fraction of GPP that is autotrophic respiration. The Net Primary Productivity (NPP) is then allocated to above and below-ground vegetation via a fixed allocation fraction. Carbon is lost from the plant pools to a single soil pool via fixed turnover rates. Heterotropic respiration in the soil is determined via a soil turnover rate.</p>
<p>The model equations are</p>
<p>-- Photosynthesis
    $$LAI = LAR*Cv$$
$$GPP = PAR * LUE * (1 - \exp^{(-KEXT * LAI)})$$
$$NPP = (1-GAMMA) * GPP$$</p>
<p>-- State equations
$$dCv/dt  = Av * NPP - Cv/tauV$$
$$dCr/dt  = (1.0-Av) * NPP - Cr/tauR$$
$$dCs/dt  = Cr/tauR + Cv/tauV - Cs/tauS$$</p>
<p>The model time-step is daily.</p>
<p>-- VSEM inputs:</p>
<p>PAR    Photosynthetically active radiation (PAR) MJ /m2 /day</p>
<p>-- VSEM parameters:</p>
<p>KEXT   Light extinction coefficient m2 ground area / m2 leaf area</p>
<p>LAR    Leaf area ratio m2 leaf area / kg aboveground vegetation</p>
<p>LUE    Light-Use Efficiency (kg C MJ-1 PAR)</p>
<p>GAMMA  Autotrophic respiration as a fraction of GPP</p>
<p>tauV   Longevity of aboveground vegetation days</p>
<p>tauR   Longevity of belowground vegetation days</p>
<p>tauS   Residence time of soil organic matter d</p>
<p>-- VSEM states:</p>
<p>Cv     Above-ground vegetation pool kg C / m2</p>
<p>Cr     Below-ground vegetation pool kg C / m2</p>
<p>Cs     Carbon in organic matter kg C / m2</p>
<p>-- VSEM fluxes:</p>
<p>G     Gross Primary Productivity kg C /m2 /day</p>
<p>NPP   Net Primary Productivity kg C /m2 /day</p>
<p>NEE   Net Ecosystem Exchange kg C /m2 /day</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='VSEMgetDefaults.html'>VSEMgetDefaults</a></code>, <code><a href='VSEMcreatePAR.html'>VSEMcreatePAR</a></code>, , <code><a href='VSEMcreateLikelihood.html'>VSEMcreateLikelihood</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>

<span class='co'>## This example shows how to run and calibrate the VSEM model </span>

<span class='fu'>library</span>(<span class='no'>BayesianTools</span>)

<span class='co'># Create input data for the model</span>
<span class='no'>PAR</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='VSEMcreatePAR.html'>VSEMcreatePAR</a></span>(<span class='fl'>1</span>:<span class='fl'>1000</span>)
<span class='fu'>plot</span>(<span class='no'>PAR</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"PAR (driving the model)"</span>, <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Day"</span>)</div><div class='img'><img src='VSEM-9.png' alt='' width='700' height='432.632880098887' /></div><div class='input'>
<span class='co'># load reference parameter definition (upper, lower prior)</span>
<span class='no'>refPars</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='VSEMgetDefaults.html'>VSEMgetDefaults</a></span>()
<span class='co'># this adds one additional parameter for the likelihood standard deviation (see below)</span>
<span class='no'>refPars</span>[<span class='fl'>12</span>,] <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>2</span>, <span class='fl'>0.1</span>, <span class='fl'>4</span>)
<span class='fu'>rownames</span>(<span class='no'>refPars</span>)[<span class='fl'>12</span>] <span class='kw'>&lt;-</span> <span class='st'>"error-sd"</span>
<span class='fu'>head</span>(<span class='no'>refPars</span>)</div><div class='output co'>#&gt;            best lower upper
#&gt; KEXT      0.500 2e-01 1e+00
#&gt; LAR       1.500 2e-01 3e+00
#&gt; LUE       0.002 5e-04 4e-03
#&gt; GAMMA     0.400 2e-01 6e-01
#&gt; tauV   1440.000 5e+02 3e+03
#&gt; tauS  27370.000 4e+03 5e+04</div><div class='input'>
<span class='co'># create some simulated test data </span>
<span class='co'># generally recommended to start with simulated data before moving to real data</span>
<span class='no'>referenceData</span> <span class='kw'>&lt;-</span> <span class='fu'>VSEM</span>(<span class='no'>refPars</span>$<span class='no'>best</span>[<span class='fl'>1</span>:<span class='fl'>11</span>], <span class='no'>PAR</span>) <span class='co'># model predictions with reference parameters  </span>
<span class='no'>referenceData</span>[,<span class='fl'>1</span>] <span class='kw'>=</span> <span class='fl'>1000</span> * <span class='no'>referenceData</span>[,<span class='fl'>1</span>]
<span class='co'># this adds the error - needs to conform to the error definition in the likelihood</span>
<span class='no'>obs</span> <span class='kw'>&lt;-</span> <span class='no'>referenceData</span> + <span class='fu'>rnorm</span>(<span class='fu'>length</span>(<span class='no'>referenceData</span>), <span class='kw'>sd</span> <span class='kw'>=</span> <span class='no'>refPars</span>$<span class='no'>best</span>[<span class='fl'>12</span>])
<span class='no'>oldpar</span> <span class='kw'>&lt;-</span> <span class='fu'>par</span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>2</span>,<span class='fl'>2</span>))
<span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='fl'>4</span>) <span class='fu'><a href='plotTimeSeries.html'>plotTimeSeries</a></span>(<span class='kw'>observed</span> <span class='kw'>=</span> <span class='no'>obs</span>[,<span class='no'>i</span>],
                              <span class='kw'>predicted</span> <span class='kw'>=</span> <span class='no'>referenceData</span>[,<span class='no'>i</span>], <span class='kw'>main</span> <span class='kw'>=</span> <span class='fu'>colnames</span>(<span class='no'>referenceData</span>)[<span class='no'>i</span>])</div><div class='img'><img src='VSEM-10.png' alt='' width='700' height='432.632880098887' /></div><div class='input'>
<span class='co'># Best to program in a way that we can choose easily which parameters to calibrate</span>
<span class='no'>parSel</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>1</span>:<span class='fl'>6</span>, <span class='fl'>12</span>)

<span class='co'># here is the likelihood </span>
<span class='no'>likelihood</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>par</span>, <span class='no'>sum</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>){
  <span class='co'># set parameters that are not calibrated on default values </span>
  <span class='no'>x</span> <span class='kw'>=</span> <span class='no'>refPars</span>$<span class='no'>best</span>
  <span class='no'>x</span>[<span class='no'>parSel</span>] <span class='kw'>=</span> <span class='no'>par</span>
  <span class='no'>predicted</span> <span class='kw'>&lt;-</span> <span class='fu'>VSEM</span>(<span class='no'>x</span>[<span class='fl'>1</span>:<span class='fl'>11</span>], <span class='no'>PAR</span>) <span class='co'># replace here VSEM with your model </span>
  <span class='no'>predicted</span>[,<span class='fl'>1</span>] <span class='kw'>=</span> <span class='fl'>1000</span> * <span class='no'>predicted</span>[,<span class='fl'>1</span>] <span class='co'># this is just rescaling</span>
  <span class='no'>diff</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='no'>predicted</span>[,<span class='fl'>1</span>:<span class='fl'>4</span>] - <span class='no'>obs</span>[,<span class='fl'>1</span>:<span class='fl'>4</span>]) <span class='co'># difference betweeno observed and predicted</span>
  <span class='co'># univariate normal likelihood. Note that there is a parameter involved here that is fit</span>
  <span class='no'>llValues</span> <span class='kw'>&lt;-</span> <span class='fu'>dnorm</span>(<span class='no'>diff</span>, <span class='kw'>sd</span> <span class='kw'>=</span> <span class='no'>x</span>[<span class='fl'>12</span>], <span class='kw'>log</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
  <span class='kw'>if</span> (<span class='no'>sum</span> <span class='kw'>==</span> <span class='fl'>FALSE</span>) <span class='fu'>return</span>(<span class='no'>llValues</span>)
  <span class='kw'>else</span> <span class='fu'>return</span>(<span class='fu'>sum</span>(<span class='no'>llValues</span>))
}

<span class='co'># optional, you can also directly provide lower, upper in the createBayesianSetup, see help</span>
<span class='no'>prior</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='createUniformPrior.html'>createUniformPrior</a></span>(<span class='kw'>lower</span> <span class='kw'>=</span> <span class='no'>refPars</span>$<span class='no'>lower</span>[<span class='no'>parSel</span>],
                            <span class='kw'>upper</span> <span class='kw'>=</span> <span class='no'>refPars</span>$<span class='no'>upper</span>[<span class='no'>parSel</span>], <span class='kw'>best</span> <span class='kw'>=</span> <span class='no'>refPars</span>$<span class='no'>best</span>[<span class='no'>parSel</span>])

<span class='no'>bayesianSetup</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='createBayesianSetup.html'>createBayesianSetup</a></span>(<span class='no'>likelihood</span>, <span class='no'>prior</span>, <span class='kw'>names</span> <span class='kw'>=</span> <span class='fu'>rownames</span>(<span class='no'>refPars</span>)[<span class='no'>parSel</span>])

<span class='co'># settings for the sampler, iterations should be increased for real applicatoin</span>
<span class='no'>settings</span> <span class='kw'>&lt;-</span> <span class='fu'>list</span>(<span class='kw'>iterations</span> <span class='kw'>=</span> <span class='fl'>2000</span>, <span class='kw'>nrChains</span> <span class='kw'>=</span> <span class='fl'>2</span>)

<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='runMCMC.html'>runMCMC</a></span>(<span class='kw'>bayesianSetup</span> <span class='kw'>=</span> <span class='no'>bayesianSetup</span>, <span class='kw'>sampler</span> <span class='kw'>=</span> <span class='st'>"DEzs"</span>, <span class='kw'>settings</span> <span class='kw'>=</span> <span class='no'>settings</span>)</div><div class='output co'>#&gt;  Running DEzs-MCMC, chain  1 iteration 300 of 2001 . Current logp  -8624.918 -8592.876 -8588.121 . Please wait!  Running DEzs-MCMC, chain  1 iteration 600 of 2001 . Current logp  -8532.735 -8537.345 -8515.801 . Please wait!  Running DEzs-MCMC, chain  1 iteration 900 of 2001 . Current logp  -8519.858 -8525.309 -8515.801 . Please wait!  Running DEzs-MCMC, chain  1 iteration 1200 of 2001 . Current logp  -8506.742 -8506.346 -8515.801 . Please wait!  Running DEzs-MCMC, chain  1 iteration 1500 of 2001 . Current logp  -8504.459 -8506.262 -8501.071 . Please wait!  Running DEzs-MCMC, chain  1 iteration 1800 of 2001 . Current logp  -8505.372 -8499.451 -8500.069 . Please wait!  Running DEzs-MCMC, chain  1 iteration 2001 of 2001 . Current logp  -8503.789 -8499.372 -8498.692 . Please wait! </div><div class='output co'>#&gt; <span class='message'>runMCMC terminated after 0.980000000000018seconds</span></div><div class='output co'>#&gt;  Running DEzs-MCMC, chain  2 iteration 300 of 2001 . Current logp  -8507.99 -8534.268 -8518.524 . Please wait!  Running DEzs-MCMC, chain  2 iteration 600 of 2001 . Current logp  -8504.173 -8511.363 -8503.835 . Please wait!  Running DEzs-MCMC, chain  2 iteration 900 of 2001 . Current logp  -8497.267 -8502.677 -8497.848 . Please wait!  Running DEzs-MCMC, chain  2 iteration 1200 of 2001 . Current logp  -8497.805 -8502.279 -8497.848 . Please wait!  Running DEzs-MCMC, chain  2 iteration 1500 of 2001 . Current logp  -8496.634 -8497.897 -8497.356 . Please wait!  Running DEzs-MCMC, chain  2 iteration 1800 of 2001 . Current logp  -8499.464 -8498.916 -8497.375 . Please wait!  Running DEzs-MCMC, chain  2 iteration 2001 of 2001 . Current logp  -8499.549 -8500.452 -8499.336 . Please wait! </div><div class='output co'>#&gt; <span class='message'>runMCMC terminated after 1seconds</span></div><div class='input'>
</div><span class='co'># NOT RUN {</span>
<span class='fu'>plot</span>(<span class='no'>out</span>)
<span class='fu'>summary</span>(<span class='no'>out</span>)
<span class='fu'><a href='marginalPlot.html'>marginalPlot</a></span>(<span class='no'>out</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='no'>T</span>)
<span class='fu'><a href='gelmanDiagnostics.html'>gelmanDiagnostics</a></span>(<span class='no'>out</span>) <span class='co'># should be below 1.05 for all parameters to demonstrate convergence </span>

<span class='co'># Posterior predictive simulations</span>

<span class='co'># Create a prediction function</span>
<span class='no'>createPredictions</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>par</span>){
  <span class='co'># set the parameters that are not calibrated on default values </span>
  <span class='no'>x</span> <span class='kw'>=</span> <span class='no'>refPars</span>$<span class='no'>best</span>
  <span class='no'>x</span>[<span class='no'>parSel</span>] <span class='kw'>=</span> <span class='no'>par</span>
  <span class='no'>predicted</span> <span class='kw'>&lt;-</span> <span class='fu'>VSEM</span>(<span class='no'>x</span>[<span class='fl'>1</span>:<span class='fl'>11</span>], <span class='no'>PAR</span>) <span class='co'># replace here VSEM with your model </span>
  <span class='fu'>return</span>(<span class='no'>predicted</span>[,<span class='fl'>1</span>] * <span class='fl'>1000</span>)
}

<span class='co'># Create an error function</span>
<span class='no'>createError</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>mean</span>, <span class='no'>par</span>){
  <span class='fu'>return</span>(<span class='fu'>rnorm</span>(<span class='fu'>length</span>(<span class='no'>mean</span>), <span class='kw'>mean</span> <span class='kw'>=</span> <span class='no'>mean</span>, <span class='kw'>sd</span> <span class='kw'>=</span> <span class='no'>par</span>[<span class='fl'>7</span>]))
}

<span class='co'># plot prior predictive distribution and prior predictive simulations</span>
<span class='fu'><a href='plotTimeSeriesResults.html'>plotTimeSeriesResults</a></span>(<span class='kw'>sampler</span> <span class='kw'>=</span> <span class='no'>out</span>, <span class='kw'>model</span> <span class='kw'>=</span> <span class='no'>createPredictions</span>, <span class='kw'>observed</span> <span class='kw'>=</span> <span class='no'>obs</span>[,<span class='fl'>1</span>],
                      <span class='kw'>error</span> <span class='kw'>=</span> <span class='no'>createError</span>, <span class='kw'>prior</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Prior predictive"</span>)

<span class='co'># plot posterior predictive distribution and posterior predictive simulations</span>
<span class='fu'><a href='plotTimeSeriesResults.html'>plotTimeSeriesResults</a></span>(<span class='kw'>sampler</span> <span class='kw'>=</span> <span class='no'>out</span>, <span class='kw'>model</span> <span class='kw'>=</span> <span class='no'>createPredictions</span>, <span class='kw'>observed</span> <span class='kw'>=</span> <span class='no'>obs</span>[,<span class='fl'>1</span>],
                      <span class='kw'>error</span> <span class='kw'>=</span> <span class='no'>createError</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Posterior predictive"</span>)


<span class='co'>########################################################</span>
<span class='co'># Demonstrating the updating of the prior from old posterior</span>
<span class='co'># Note that it is usually more exact to rerun the MCMC </span>
<span class='co'># with all (old and new) data, instead of updating the prior</span>
<span class='co'># because likely some information is lost when approximating the</span>
<span class='co'># Posterior by a multivariate normal </span>

<span class='no'>settings</span> <span class='kw'>&lt;-</span> <span class='fu'>list</span>(<span class='kw'>iterations</span> <span class='kw'>=</span> <span class='fl'>5000</span>, <span class='kw'>nrChains</span> <span class='kw'>=</span> <span class='fl'>2</span>)

<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='runMCMC.html'>runMCMC</a></span>(<span class='kw'>bayesianSetup</span> <span class='kw'>=</span> <span class='no'>bayesianSetup</span>, <span class='kw'>sampler</span> <span class='kw'>=</span> <span class='st'>"DEzs"</span>, <span class='kw'>settings</span> <span class='kw'>=</span> <span class='no'>settings</span>)

<span class='fu'>plot</span>(<span class='no'>out</span>)
<span class='fu'><a href='correlationPlot.html'>correlationPlot</a></span>(<span class='no'>out</span>, <span class='kw'>start</span> <span class='kw'>=</span> <span class='fl'>1000</span>)

<span class='no'>newPrior</span> <span class='kw'>=</span> <span class='fu'><a href='createPriorDensity.html'>createPriorDensity</a></span>(<span class='no'>out</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"multivariate"</span>,
                              <span class='kw'>eps</span> <span class='kw'>=</span> <span class='fl'>1e-10</span>,
                              <span class='kw'>lower</span> <span class='kw'>=</span> <span class='no'>refPars</span>$<span class='no'>lower</span>[<span class='no'>parSel</span>],
                              <span class='kw'>upper</span> <span class='kw'>=</span> <span class='no'>refPars</span>$<span class='no'>upper</span>[<span class='no'>parSel</span>], <span class='kw'>start</span><span class='kw'>=</span> <span class='fl'>1000</span>)

<span class='no'>bayesianSetup</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='createBayesianSetup.html'>createBayesianSetup</a></span>(<span class='kw'>likelihood</span> <span class='kw'>=</span> <span class='no'>likelihood</span>,
                                     <span class='kw'>prior</span> <span class='kw'>=</span> <span class='no'>newPrior</span>,
                                     <span class='kw'>names</span> <span class='kw'>=</span> <span class='fu'>rownames</span>(<span class='no'>refPars</span>)[<span class='no'>parSel</span>] )

<span class='co'># check boundaries are correct set</span>
<span class='no'>bayesianSetup</span>$<span class='no'>prior</span>$<span class='fu'>sampler</span>() <span class='kw'>&lt;</span> <span class='no'>refPars</span>$<span class='no'>lower</span>[<span class='no'>parSel</span>]
<span class='no'>bayesianSetup</span>$<span class='no'>prior</span>$<span class='fu'>sampler</span>() <span class='kw'>&gt;</span> <span class='no'>refPars</span>$<span class='no'>upper</span>[<span class='no'>parSel</span>]

<span class='co'># check prior looks similar to posterior</span>
<span class='no'>x</span> <span class='kw'>=</span> <span class='no'>bayesianSetup</span>$<span class='no'>prior</span>$<span class='fu'>sampler</span>(<span class='fl'>2000</span>)
<span class='fu'><a href='correlationPlot.html'>correlationPlot</a></span>(<span class='no'>x</span>, <span class='kw'>thin</span> <span class='kw'>=</span> <span class='no'>F</span>)

<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='runMCMC.html'>runMCMC</a></span>(<span class='kw'>bayesianSetup</span> <span class='kw'>=</span> <span class='no'>bayesianSetup</span>, <span class='kw'>sampler</span> <span class='kw'>=</span> <span class='st'>"DEzs"</span>, <span class='kw'>settings</span> <span class='kw'>=</span> <span class='no'>settings</span>)

<span class='fu'>plot</span>(<span class='no'>out</span>)
<span class='fu'><a href='correlationPlot.html'>correlationPlot</a></span>(<span class='no'>out</span>)

<span class='fu'><a href='plotTimeSeriesResults.html'>plotTimeSeriesResults</a></span>(<span class='kw'>sampler</span> <span class='kw'>=</span> <span class='no'>out</span>,
                      <span class='kw'>model</span> <span class='kw'>=</span> <span class='no'>createPredictions</span>,
                      <span class='kw'>observed</span> <span class='kw'>=</span> <span class='no'>obs</span>[,<span class='fl'>1</span>],
                      <span class='kw'>error</span> <span class='kw'>=</span> <span class='no'>createError</span>,
                      <span class='kw'>prior</span> <span class='kw'>=</span> <span class='no'>F</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Posterior predictive"</span>)

<span class='fu'><a href='plotTimeSeriesResults.html'>plotTimeSeriesResults</a></span>(<span class='kw'>sampler</span> <span class='kw'>=</span> <span class='no'>out</span>,
                      <span class='kw'>model</span> <span class='kw'>=</span> <span class='no'>createPredictions</span>,
                      <span class='kw'>observed</span> <span class='kw'>=</span> <span class='no'>obs</span>[,<span class='fl'>1</span>],
                      <span class='kw'>error</span> <span class='kw'>=</span> <span class='no'>createError</span>,
                      <span class='kw'>prior</span> <span class='kw'>=</span> <span class='no'>T</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Prior predictive"</span>)




<span class='co'># }</span><div class='input'>
<span class='fu'>par</span>(<span class='no'>oldpar</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
David Cameron, R and C implementation by Florian Hartig

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Florian Hartig, Francesco Minunno, Stefan  Paul.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
